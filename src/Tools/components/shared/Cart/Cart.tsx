import { useAppSelector } from "../../../hooks/reduxHooks"

import { useEffect, useState } from "react"

import style from "./cartStyle.module.css"
import { Link } from "react-router-dom"

const {cart, circleInCart, cartDrobDown} = style

function Cart() {
    const [isanimate, SetIsAnimate] = useState(false)

    const quantityStyle = `${circleInCart} ${
    isanimate? cartDrobDown: ""}`


    const {items} = useAppSelector(state => state.cart)
    const totalQuantaty = Object.values(items).reduce((a, b) => {return a + b}, 0)

    useEffect( ()=>{
        if(!totalQuantaty) {
            return;
        }

        SetIsAnimate(true)

        const debounce = setTimeout(()=>{
            SetIsAnimate(false)
        },500)

        return () => clearTimeout(debounce)
        
    },[totalQuantaty] )


    return (
        <>
            <div style={{position: "relative"}}>
                <Link to={"/CartPage"} className={cart} >
                    <div className={quantityStyle} > {totalQuantaty} </div>
                    <svg xmlns="http://www.w3.org/2000/svg" 
                    fill="#fff"
                    className="bi bi-cart4 me-4 mt-2"
                    viewBox="0 0 20 20" 
                    id="Cart4--Streamline-Bootstrap" 
                    height="27" 
                    width="27">
                        <desc>Cart4 Streamline Icon: https://streamlinehq.com</desc>
                        <path d="M0.2 1.506625C0.2 1.14575 0.49250000000000005 0.85325 0.853375 0.85325H2.813375C3.1132500000000003 0.853375 3.3745000000000003 1.0574999999999999 3.4471249999999998 1.3485L3.9762500000000003 3.4666249999999996H19.146875C19.571624999999997 3.46675 19.883375 3.865875 19.780625 4.2780000000000005L17.820625 12.118125C17.747999999999998 12.409125000000001 17.486625 12.61325 17.186875 12.613375H5.42675C5.126875 12.61325 4.8655 12.409125000000001 4.793 12.118125L2.30375 2.159875H0.853375C0.49250000000000005 2.16 0.2 1.867375 0.2 1.506625M4.303 4.77325L4.956375 7.386625H6.7333750000000006V4.77325ZM8.040125 4.77325V7.386625H10.653500000000001V4.77325ZM11.960125 4.77325V7.386625H14.5735V4.77325ZM15.880125 4.77325V7.386625H17.65725L18.310625 4.77325ZM17.330624999999998 8.693375H15.880125V11.306624999999999H16.67725ZM14.5735 8.693375H11.960125V11.306624999999999H14.5735ZM10.653375 8.693375H8.040125V11.306624999999999H10.653500000000001ZM6.7333750000000006 8.693375H5.2829999999999995L5.936249999999999 11.306624999999999H6.7333750000000006ZM6.7333750000000006 15.22675C5.7275 15.22675 5.0988750000000005 16.315625 5.60175 17.18675C5.835249999999999 17.591 6.266500000000001 17.840125 6.7333750000000006 17.840125C7.73925 17.84 8.368 16.751125000000002 7.865 15.88C7.6315 15.47575 7.2002500000000005 15.22675 6.7333750000000006 15.22675M4.12 16.533375C4.115625 14.521625 6.2906249999999995 13.2595 8.035124999999999 14.261625C8.84825 14.728625 9.34875 15.595625 9.34675 16.533375C9.342375 18.545125 7.16175 19.79775 5.421749999999999 18.788C4.61775 18.3215 4.122 17.463 4.12 16.533375M15.880125 15.22675C14.87425 15.22675 14.245625 16.315625 14.7485 17.18675C14.981875 17.591 15.413250000000001 17.840125 15.880125 17.840125C16.886000000000003 17.84 17.51475 16.751125000000002 17.01175 15.88C16.77825 15.47575 16.346875 15.22675 15.880125 15.22675M13.26675 16.533375C13.262374999999999 14.521625 15.437375 13.2595 17.181874999999998 14.261625C17.995 14.728625 18.4955 15.595625 18.4935 16.533375C18.489125 18.545125 16.3085 19.79775 14.5685 18.788C13.7645 18.3215 13.26875 17.463 13.26675 16.533375" strokeWidth="1">
                        </path>
                    </svg>
                </Link>
            </div>

        </>
    )
}

export default Cart;